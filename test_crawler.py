"""
제공된 HTML 테이블에서 데이터를 추출하는 테스트 스크립트
"""
from crawler import YahooFinanceCrawler

# 사용자가 제공한 HTML (일부만 있음)
html_sample = """<table class="yf-1uayyp1 bd"><thead class="yf-1uayyp1"><tr class="yf-1uayyp1"><th data-testid-header="ticker" class="[&amp;_.symbol]:tw-text-md yf-1uayyp1 so lpin shad"><div class="colCont yf-1uayyp1"> Symbol</div></th><th data-testid-header="companyshortname.raw" class="leftAlignHeader companyName yf-1uayyp1 so"><div class="colCont yf-1uayyp1"> Name</div></th><th data-testid-header="sparkline" class=" yf-1uayyp1"><div class="colCont yf-1uayyp1"> <span data-svelte-h="svelte-1uypmr0">&nbsp;</span></div></th><th data-testid-header="intradayprice" class="yf-1uayyp1 so"><div class="colCont yf-1uayyp1"> <div class="container yf-1d5e06g"><span>Price</span> </div></div></th><th data-testid-header="intradaypricechange" class="yf-1uayyp1 so"><div class="colCont yf-1uayyp1"> Change</div></th><th data-testid-header="percentchange" class="yf-1uayyp1 so sorted"><div class="colCont yf-1uayyp1"><div aria-hidden="true" class="icon fin-icon inherit-icn sz-medium yf-sv6wwp"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div> Change %</div></th><th data-testid-header="dayvolume" class="yf-1uayyp1 so"><div class="colCont yf-1uayyp1"> Volume</div></th><th data-testid-header="avgdailyvol3m" class="yf-1uayyp1 so"><div class="colCont yf-1uayyp1"> Avg Vol (3M)</div></th><th data-testid-header="intradaymarketcap" class="yf-1uayyp1 so"><div class="colCont yf-1uayyp1"> Market Cap</div></th><th data-testid-header="peratio.lasttwelvemonths" class="yf-1uayyp1 so"><div class="colCont yf-1uayyp1"> <div class="yf-10yevti"><span>P/E Ratio </span><span>(TTM) </span></div></div></th><th data-testid-header="fiftytwowkpercentchange" class="yf-1uayyp1 so"><div class="colCont yf-1uayyp1"> <div class="yf-10yevti"><span>52 Wk </span><span>Change % </span></div></div></th><th data-testid-header="fiftyTwoWeekRange" class=" yf-1uayyp1"><div class="colCont yf-1uayyp1"> 52 Wk Range</div></th> </tr></thead> <tbody><tr class="row yf-1uayyp1" data-testid="data-table-v2-row" data-testid-row="0"><td data-testid-cell="ticker" class="[&amp;_.symbol]:tw-text-md yf-1uayyp1 lpin shad" style="--_depth: false;"><div style="display: contents; --background-color:transparent; --hover-bg-color:transparent; --hover-color:var(--enabled-active-emph); --text-color:var(--enabled-active-emph); --hover-focus-color:var(--hovered-emph-same); --text-decoration:underline;"><span class="ticker-wrapper yf-1pdfbgz"><a data-testid="table-cell-ticker" class="ticker medium [&amp;_.symbol]:tw-text-md hover noPadding yf-1pdfbgz" aria-label="Companhia Paranaense de Energia" data-ylk="elm:qte;elmt:link;itc:0;sec:stocks-datatable;slk:ELPC" href="/quote/ELPC/" title="Companhia Paranaense de Energia" data-rapid_p="24" data-v9y="1"> <div class="name yf-1pdfbgz"><span class="symbol yf-1pdfbgz">ELPC </span> </div>  </a> </span></div> </td><td data-testid-cell="companyshortname.raw" class="leftAlignHeader companyName yf-1uayyp1" style="--_depth: false;"><div title="Companhia Paranaense de Energia" class="leftAlignHeader companyName yf-362rys enableMaxWidth">Companhia Paranaense de Energia</div> </td><td data-testid-cell="sparkline" class=" yf-1uayyp1" style="--_depth: false;"><div class="yf-1rh4oll expandWidth enableMaxWidth"><a class="none-link fin-size-small yf-119g04z" data-ylk="elm:chart;elmt:link;itc:0;sec:stocks-datatable;slk:ELPC" href="/chart/ELPC" aria-label="Advanced Chart" data-rapid_p="25" data-v9y="1"><figure class=" yf-qqbabn" data-testid="sparkline"><canvas aria-label="ELPC chart" class=" yf-qqbabn" width="50" height="20" style="width: 50px; height: 20px;"></canvas></figure> </a></div> </td><td data-testid-cell="intradayprice" class=" yf-1uayyp1" style="--_depth: false;"><div class=""><fin-streamer data-test="change" data-symbol="ELPC" data-field="regularMarketPrice" data-trend="none" data-value="9.65" active="">9.65</fin-streamer> <div class="hide-desktop hide-mw txt-positive"><fin-streamer data-test="colorChange" data-field="regularMarketChange" data-trend="txt" data-value="0.79" active="">+0.79</fin-streamer> <fin-streamer data-test="colorChange" data-template="({fmt})" data-field="regularMarketChangePercent" data-trend="txt" data-value="8.91648" active="">(+8.92%)</fin-streamer></div></div> </td><td data-testid-cell="intradaypricechange" class=" yf-1uayyp1" style="--_depth: false;"><fin-streamer class="txt-positive" data-test="colorChange" data-symbol="ELPC" data-field="regularMarketChange" data-trend="txt" data-pricehint="2" data-value="0.79" data-tstyle="default" active="">+0.79</fin-streamer> </td><td data-testid-cell="percentchange" class=" yf-1uayyp1" style="--_depth: false;"><fin-streamer class="txt-positive" data-test="colorChange" data-symbol="ELPC" data-field="regularMarketChangePercent" data-trend="txt" data-pricehint="2" data-value="8.91648" data-tstyle="default" active="">+8.92%</fin-streamer> </td><td data-testid-cell="dayvolume" class=" yf-1uayyp1" style="--_depth: false;"><fin-streamer data-test="change" data-symbol="ELPC" data-field="regularMarketVolume" data-trend="none" data-value="30234" active="">30,234</fin-streamer> </td><td data-testid-cell="avgdailyvol3m" class=" yf-1uayyp1" style="--_depth: false;">7,850 </td><td data-testid-cell="intradaymarketcap" class=" yf-1uayyp1" style="--_depth: false;"><fin-streamer data-test="change" data-symbol="ELPC" data-field="marketCap" data-trend="none" data-value="7164238007.24378" active="">7.164B</fin-streamer> </td><td data-testid-cell="peratio.lasttwelvemonths" class=" yf-1uayyp1" style="--_depth: false;">13.90 </td><td data-testid-cell="fiftytwowkpercentchange" class=" yf-1uayyp1" style="--_depth: false;"><fin-streamer class="txt-positive" data-test="colorChange" data-symbol="ELPC" data-field="fiftyTwoWeekChangePercent" data-trend="txt" data-pricehint="2" data-value="66.260086" data-tstyle="default" active="">+66.26%</fin-streamer> </td><td data-testid-cell="fiftyTwoWeekRange" class=" yf-1uayyp1" style="--_depth: false;"><div class="container yf-wummfw" role="img" aria-label="Graph showing stock performance over fifty two week range"><div class="line yf-wummfw" style="top: 11px;height: 2px;"><div class="candle yf-wummfw" style="top: 0;height: 2px;left: 110.00px;width: 6px;"></div> <svg width="8" height="10" viewBox="0 0 80 110" xmlns="http://www.w3.org/2000/svg" style="top: -12px; left: 113px;" class="yf-wummfw"><path d="M 0 40 A 40 40 0 0 1 80 40 L 40 110 Z"></path></svg></div> <div class="labels yf-wummfw"><span>5.04</span> <span>10.51</span></div></div> </td></tr></tbody></table>"""

def main():
    crawler = YahooFinanceCrawler()
    
    print("제공된 HTML 샘플에서 데이터 추출 테스트...")
    stocks = crawler.parse_html_table(html_sample)
    
    if stocks:
        print(f"\n추출된 주식 수: {len(stocks)}개")
        print("\n=== 첫 번째 주식 데이터 ===")
        stock = stocks[0]
        for key, value in stock.items():
            print(f"{key}: {value}")
    else:
        print("데이터를 추출할 수 없습니다.")

if __name__ == "__main__":
    main()

